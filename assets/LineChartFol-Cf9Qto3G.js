import{u as P}from"./index-cPYpxCiT.js";import{i as R}from"./index-B5d4h4Xc.js";import{_ as J}from"./BatteryView.vue_vue_type_style_index_0_computed_true_lang-IcHe8xCW.js";import{u as U}from"./http-cNaCE5ub.js";import{d as D,g as d,i as L,h as q,c as A,f as T,u as b,a as w,e as p,k as z,t as H,n as E,o as S,b as I,w as O,y as j,F as W}from"./index-CusKfgHS.js";import{_ as Y}from"./InputView.vue_vue_type_style_index_0_lang-cWWQN7F6.js";import{_ as X}from"./MainWrapperView.vue_vue_type_style_index_0_lang-Dr9vaoNK.js";import{_ as Z}from"./SelectView.vue_vue_type_style_index_0_lang-D2zhla7d.js";import"./moment-C5S46NFB.js";const Q={style:{width:"200px",position:"relative",background:"#eee",height:"5px","border-radius":"10px"}},ee=D({__name:"ChartLineView",props:{ch_name:{type:String,required:!0},ch_spot:{type:[Number],required:!0},ch_filter_date:{type:String,required:!0},ch_ymax:{type:Number,default:500},ch_ymin:{type:Number,default:0},ch_timesplit:{type:Number,default:30}},setup(G){const s=P(),t=G,o=d(t.ch_ymax);d(0),t.ch_spot==1||t.ch_spot==2||t.ch_spot==15||t.ch_spot==16?o.value=200:t.ch_spot==3||t.ch_spot==4?o.value=300:t.ch_spot==9?o.value=100:(t.ch_spot==10||t.ch_spot==11||t.ch_spot==12||t.ch_spot==13)&&(o.value=250);const x=d(null),f=d(!0),n=d(0),a=d(null),c=d(!1),$=d([]),g={notMerge:!0,lazyUpdate:!0,tooltip:{trigger:"axis",axisPointer:{type:"cross"}},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},dataView:{readOnly:!1},magicType:{type:["line","bar"]},restore:{},saveAsImage:{},brush:{type:["lineX","clear"]}},iconStyle:{color:`${s.accentColor}`}},axisPointer:{link:{xAxisIndex:"all"},label:{backgroundColor:"#777"}},legend:{textStyle:{color:`${s.accentColor}`}},xAxis:{name:"Time",type:"category",nameLocation:"middle",nameTextStyle:{lineHeight:60},axisLine:{show:!0},splitLine:{show:!0,lineStyle:{color:"#cccccccc"}},axisLabel:{rotate:-45,color:`${s.accentColor}`,formatter:r=>r},boundaryGap:!1,axisTick:{alignWithLabel:!0},data:[]},yAxis:{name:"Pressure (PSI)",nameLocation:"middle",min:t.ch_ymin,nameGap:40,max:o.value,splitLine:{lineStyle:{color:"#ccccccaa"}},nameTextStyle:{verticalAlign:"middle"},axisTick:{show:!0},axisLabel:{color:`${s.accentColor}`},type:"value",axisLine:{show:!0}},series:[]};setTimeout(()=>{a.value.setOption(g)},500);const B=r=>new Date(r).toISOString(),M=async()=>{try{const r={id:t.ch_spot+"",date:B(t.ch_filter_date)},h=await U().httpPost("api/Data/getspotdata",r);n.value=80;const v=[];for(let m=0;m<24;m++)for(let u=0;u<60;u++)v.push(`${m<10?"0"+m:m}:${u<10?"0"+u:u}`);$.value=v,n.value=85;const y=h.map(m=>parseFloat(m.psiValue).toFixed(2));g.xAxis=[{data:v}],g.series=[{name:"Pressure",data:y,type:"line",itemStyle:{normal:{color:"#06B800",color0:"#FA0000",borderColor:null,borderColor0:null,opacity:0}},endLabel:{show:!0,fontSize:8,color:"#fff",offset:[-5,0],padding:3,borderRadius:3,textBorderWidth:0,backgroundColor:s.accentColorSecondary,formatter:function(m){const u=y;let l=0,i=0,C=0;for(let _=0;_<u.length;_++)u[_]>C&&(C=u[_]);for(let _=0;_<u.length;_++){const e=parseInt(u[_]);(t.ch_spot==1&&e>=128&&e<=150||t.ch_spot==2&&e>=70&&e<=100||t.ch_spot==3&&e>=120&&e<=150||t.ch_spot==4&&e>=16&&e<=38||t.ch_spot==5&&e>=250&&e<=300||t.ch_spot==6&&e>=225&&e<=250||t.ch_spot==7&&e>=50&&e<=100||t.ch_spot==8&&e>=200&&e<=260||t.ch_spot==9&&e>=38&&e<=50||t.ch_spot==10&&e>=10&&e<=56||t.ch_spot==11&&e>=7&&e<=35||t.ch_spot==12&&e>=38&&e<=50||t.ch_spot==13&&e>=3&&e<=30||t.ch_spot==14&&e>=38&&e<=50)&&(l+=e,i++)}const N=m.data,F=C,V=(F-N)/F*100,K=l/i;return`Cur: ${parseFloat(m.data).toFixed(2)}
Avg: ${parseFloat(K).toFixed(2)}
Delt: ${V.toFixed(2)}%`}},lineStyle:{color:"#007BFF",width:2}}],a.value.setOption(g),n.value=99,setTimeout(()=>{f.value=!1,n.value=0},1e3)}catch(r){console.log(r),f.value=!1}c.value=!0},k=()=>new Promise((r,h)=>{const v={toolbox:{iconStyle:{color:`${s.accentColor}`}},legend:{textStyle:{color:`${s.accentColor}`}},xAxis:{axisLabel:{rotate:-45,color:`${s.accentColor}`}},yAxis:{splitLine:{lineStyle:{color:"#cccccc11"}},axisLabel:{color:`${s.accentColor}`}}};try{a.value.setOption(v),r()}catch(y){h(y)}});return L(()=>[a.value,t.ch_filter_date],()=>{f.value=!0,n.value=0,setTimeout(()=>{a.value.setOption({series:[]}),n.value=12,M()},500)}),L(()=>[s.accentColor],async()=>{await k().then(()=>{})}),L(()=>t.ch_timesplit,()=>{const r={xAxis:{axisLabel:{formatter:h=>{const v=h.split(":")[0],y=h.split(":")[1];return y%t.ch_timesplit===0?`${v}:${y}`:""}}}};a.value.setOption(r)}),setInterval(()=>{c.value&&M()},15e3),q(()=>{const r=R(x.value);a.value=r}),(r,h)=>(S(),A("div",{class:"chparent",style:T({border:`1px solid ${b(s).accentColor}`})},[w(J,{"id-spot":t.ch_spot},null,8,["id-spot"]),p("h3",{style:T({color:`${b(s).accentColorSecondary}`})},H(t.ch_name),5),p("div",{ref_key:"chart",ref:x,style:{width:"565px",height:"300px"}},null,512),f.value?(S(),A("div",{key:0,class:E(["chloader",[`${b(s).mTheme}`]])},[h[0]||(h[0]=p("img",{src:"https://i.pinimg.com/originals/cb/17/b8/cb17b80a942d7c317a35ff1324fae12f.gif"},null,-1)),p("div",Q,[p("span",{style:T([{"border-radius":"10px",position:"absolute",top:"0",left:"0",height:"100%",transition:"ease-in-out 1s"},{width:`${n.value}%`,background:`${b(s).accentColor}`}])},null,4)])],2)):z("",!0)],4))}}),te={class:"col-md-3"},oe={class:"chartcontainer"},he=D({__name:"LineChartFol",setup(G){P().asideToggle(!1);const t=()=>{const n=new Date,a=n.getFullYear(),c=String(n.getMonth()+1).padStart(2,"0"),$=String(n.getDate()).padStart(2,"0");return`${a}-${c}-${$}`},o=d(60),x=d(t()),f=d({1:{spot:"MGS BJG",id:1},2:{spot:"MGS BJG (1)",id:15},3:{spot:"BOOSTER",id:2},4:{spot:"MGS BJG (2)",id:16},5:{spot:"MGS KAS",id:3},6:{spot:"MOS TPN",id:4},7:{spot:"GS 02 SGL",id:5},8:{spot:"GS 02 SGL (02)",id:6},9:{spot:"GS 02 SGL (03)",id:7},10:{spot:"GS 01 KTT",id:8},11:{spot:"MGS TPN",id:9},12:{spot:"0 KM SP BETUNG",id:10},13:{spot:"5.3 KM SIMP. PASAR GAJAH (5.3)",id:11},14:{spot:"9.5 KM SANDTRAP II (4.2)",id:12},15:{spot:"13.8 KM MGS BJG (4.3)",id:13},16:{spot:"MINIATUR (CIP)",id:14}});return(n,a)=>(S(),I(X,{"context-title":"FOL | Line Chart"},{default:O(()=>[p("div",te,[w(Y,{"in-type":"date","in-label":"Date Filter","model-value":x.value,"onUpdate:modelValue":a[0]||(a[0]=c=>x.value=c)},null,8,["model-value"]),w(Z,{"in-label":"Time split","model-value":o.value,"onUpdate:modelValue":a[1]||(a[1]=c=>o.value=c)},{default:O(()=>a[2]||(a[2]=[p("option",{value:"5"},"5 Minutes",-1),p("option",{value:"15"},"15 Minutes",-1),p("option",{value:"30"},"30 Minutes",-1),p("option",{value:"45"},"45 Minutes",-1),p("option",{value:"60"},"1 Hour",-1)])),_:1},8,["model-value"])]),p("div",oe,[(S(!0),A(W,null,j(Object.keys(f.value),c=>(S(),I(ee,{key:c,ch_timesplit:o.value,ch_name:f.value[c].spot,ch_filter_date:x.value,ch_spot:f.value[c].id},null,8,["ch_timesplit","ch_name","ch_filter_date","ch_spot"]))),128))])]),_:1}))}});export{he as default};
