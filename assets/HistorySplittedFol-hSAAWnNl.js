import{d as gt,g as p,i as O,B as ht,h as kt,c as i,k as x,a as v,e as t,r as Ee,f,u as r,l as g,w as T,F as b,y as L,b as te,t as y,n as k,v as Ke,x as je,o}from"./index-gADT0Y1l.js";import{_ as fe}from"./InputView.vue_vue_type_style_index_0_lang-SMHZyz9o.js";import{_ as xt}from"./MainWrapperView.vue_vue_type_style_index_0_lang-DSH5KTC-.js";import{u as wt}from"./index-CLUB-lar.js";import{_ as me}from"./SelectView.vue_vue_type_style_index_0_lang-zBzD7R1U.js";import{_ as N}from"./ButtonView.vue_vue_type_style_index_0_computed_true_lang-Bg9X1S6w.js";import{_ as Ve,a as _t,m as Dt,u as Ct}from"./HistoryECharts.vue_vue_type_script_setup_true_lang-CdbJx1OQ.js";import{u as $t}from"./http-c2aLmsiR.js";import{_ as Ue}from"./CheckboxView.vue_vue_type_style_index_0_computed_true_lang-DKm01gpT.js";import{i as Lt}from"./index-B5d4h4Xc.js";import{t as Tt}from"./trunk-dwr8fwI0.js";import{h as St}from"./moment-C5S46NFB.js";const Pt={key:0,class:"q-prd-win"},Vt=["value"],Mt={key:0,style:{display:"flex","flex-flow":"row wrap",gap:"1rem"}},At={key:1,style:{color:"red","font-weight":"bold"}},Rt={key:2,style:{padding:"2rem",position:"relative",width:"100%"}},Ft={style:{"margin-top":"1rem",width:"100%",position:"relative",display:"flex","flex-flow":"column","align-items":"center"}},Ot={style:{color:"red","text-transform":"capitalize"}},It={key:0},Nt={class:"col-md-12"},Et={style:{display:"flex","flex-flow":"row nowrap","justify-content":"flex-end"}},Kt={class:"col-md-3"},jt=["value"],Ut={style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},qt={style:{display:"flex","flex-flow":"row nowrap",gap:"1rem","align-items":"center"}},Bt={class:"col-md-12"},zt={class:"table-responsive"},Yt={style:{display:"flex","flex-flow":"row nowrap","justify-content":"flex-end",gap:"1rem"}},Ht={style:{display:"flex","flex-flow":"row wrap","justify-content":"flex-end","align-items":"center",gap:"0.5rem","margin-bottom":"1rem",border:"1px solid #ccc",width:"fit-content",padding:"10px","border-radius":"100px"}},Gt={style:{display:"flex","flex-flow":"row nowrap","align-items":"center"}},Wt={style:{display:"flex","flex-flow":"row nowrap","align-items":"center"}},Qt={class:"tbl"},Zt={class:"theads"},Jt={style:{display:"flex","flex-flow":"column",width:"150px"}},Xt={style:{"font-size":"14px","font-weight":"bold"}},el={key:1,style:{color:"#ccc"}},tl={style:{display:"flex","flex-flow":"row nowrap"}},ll={style:{width:"100%",display:"flex","flex-flow":"column"}},al=["src"],ol={class:"col-md-12",style:{"margin-bottom":"1rem","margin-top":"2rem"}},nl={class:"table-responsive"},sl={class:"tbl2"},il=["onClick"],ul={class:"tbl2"},rl={key:2,class:"leak-window"},dl={class:"table-responsive"},cl={key:0},pl=["href"],vl={style:{color:"#555"}},yl={style:{"margin-top":"1rem"}},fl={key:1},ml={style:{"margin-top":"1rem"}},bl={key:3,class:"playback-controller"},gl={style:{display:"flex","flex-flow":"row nowrap",gap:".5rem"}},hl={style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},kl={style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},xl={style:{"border-radius":"10px",display:"flex","flex-flow":"row nowrap","justify-content":"space-between","padding-left":"10px","padding-right":"10px",border:"1px solid #ccc",padding:"20px","margin-bottom":"1rem"}},wl={style:{border:"1px solid #ccc",padding:"10px","padding-left":"40px","padding-right":"40px","border-radius":"100px"}},_l={style:{display:"flex","flex-flow":"row nowrap",width:"100%","align-items":"center"}},Dl={style:{display:"flex","flex-flow":"no wrap",padding:"10px",gap:"0.5rem"}},Cl={style:{width:"100%",padding:"10px",position:"relative"}},$l=["max","value"],Ll={class:"slider-highlight"},Tl={key:4,class:"pb-prompt"},Sl={class:"pbp-inner"},Pl={style:{"text-align":"center"}},Bl=gt({__name:"HistorySplittedFol",setup(Vl){const qe=Tt(),be=p(),ge=p(),he=p(),D=p(qe.getAllTrunk()),C=p("trunk1"),E=p([]),le=Ct(),P=p([]),_=p(0),B=p(0);p("normal");const ae=p(500);he.value=Object.keys(D.value);const d=wt(),oe=p(60),V=p(),z=p([]),ke=p(!1);d.asideToggle(!1);const Be=()=>{const n=new Date,e=n.getFullYear(),s=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),l=`${e}-${s}-${a}`;V.value=l};O(()=>[V.value,oe.value,C.value],async()=>{await ne()});const Me=async n=>new Promise(async(e,s)=>{try{const a=D.value[C.value];let l=[];for(let h=0;h<a.spot.length;h++)l.push(a.spot[h].id);const u={datefilter:n,timeFilter:oe.value,idFilter:l},c=await $t().httpPost("api/History/getsplittedhistdata",u);e(c)}catch(a){s(a)}}),Ae=p({});function ze(n){const e={};return n.forEach(s=>{s.data.forEach(a=>{const{idSpot:l,avgPsiValues:u}=a;e[l]?(u>e[l].maxValue&&(e[l].maxValue=u),u<e[l].minValue&&(e[l].minValue=u)):e[l]={maxValue:u,minValue:u}})}),Ae.value=e,Ae.value}const Ye=ht(()=>ze(z.value));function He(n,e){const s=Ye.value;if(!s[e])return"";const a=n.data.find(l=>l.idSpot===e);if(a){if(a.avgPsiValues===s[e].maxValue)return"highest-value";if(a.avgPsiValues===s[e].minValue)return"lowest-value"}return""}const m=p({});let xe=null;const A=p(null),we=p({});O(()=>m.value,()=>{if(console.log("Selected Data (Before Sort):",m.value),xe=Object.keys(m.value),Y(),A.value!=null){we.value=[];const n=A.value,e=m.value[n].data;xe.filter(a=>a!==n).forEach(a=>{const l=m.value[a].data,u=[];D.value[C.value].spot.forEach((c,h)=>{const M=c.id,q=e.find(ee=>ee.idSpot===M),Ne=l.find(ee=>ee.idSpot===M);if(q&&Ne){const ee=q.avgPsiValues-Ne.avgPsiValues;u[h]=ee}else u[h]=0}),we.value.push({dropKey:a,deltas:u})})}});const Re=(n,e,s)=>{const a=e.timeRange,l=e.type,u=e.rangeData,c=e.dateFilter;n?(m.value[a+"."+l+"."+c]={timerange:a,type:l,checkbox:s,data:u,date:c},l==="normal"&&(A.value=a+"."+l+"."+c),m.value=Fe(m.value),Y()):(delete m.value[a+"."+l+"."+c],l==="normal"&&A.value===a+"."+l+"."+c&&(A.value=null),m.value=Fe(m.value),Je(!0))},Fe=n=>{const e=Object.entries(n);return e.sort((s,a)=>s[1].type==="normal"&&a[1].type!=="normal"?-1:s[1].type!=="normal"&&a[1].type==="normal"?1:0),Object.fromEntries(e)},Ge=n=>A.value!==null&&A.value!==n.timeRange+"."+n.type+"."+n.date,Y=()=>{Object.keys(m.value).length>1?ke.value=!0:ke.value=!1},We=async()=>{z.value=[],_e(),Y(),await ne().then(()=>{}).catch(n=>{})},ne=async()=>{_e(),z.value=[];try{let e=[...await Me(V.value)];if(E.value.length>0)for(let s=0;s<E.value.length;s++){const a=E.value[s];if(a!==null){if(a.value!==V.value){const l=await Me(a.value);e=e.concat(l)}}else console.log("Null")}z.value=e,P.value=e}catch(n){console.log(n)}},Qe=()=>{_e(),Y(),ie.value=[]},_e=()=>{Object.keys(m.value).forEach(n=>{const e=m.value[n].checkbox;e.checked=!1}),A.value=null,m.value={},Y()},se=p(),Ze=async(n,e)=>{const s=n.map((c,h)=>{const M=c.length>1?c.map(q=>Number(q)||0):[0];return h==0?{name:"Normal",type:"line",data:M,smooth:!0}:{name:"Drop "+h,type:"line",data:M,smooth:!0}});let a=[];for(let c=0;c<D.value[C.value].spot.length;c++)a.push(D.value[C.value].spot[c].name);const l=await Promise.all(s);l.sort((c,h)=>c.name==="Normal"?-1:h.name==="Normal"?1:0);const u={toolbox:{show:!0,orient:"vertical",feature:{dataZoom:{yAxisIndex:"none"},dataView:{readOnly:!1},magicType:{type:["line","bar"]},restore:{},saveAsImage:{}}},tooltip:{trigger:"item",axisPointer:{type:"cross"}},grid:{left:"10%",right:"10%",bottom:"10%",containLabel:!0},legend:{show:!0},xAxis:{type:"category",data:a,axisLabel:{show:!0,rotate:45},boundaryGap:!1,axisTick:{alignWithLabel:!0}},yAxis:{name:"Pressure (PSI)",nameTextStyle:{verticalAlign:"middle"},axisTick:{show:!0,inside:!0},type:"value",axisLine:{show:!0}},series:l};if(!e)se.value.setOption(u);else{let c={toolbox:{show:!0,orient:"vertical",feature:{dataZoom:{yAxisIndex:"none"},dataView:{readOnly:!1},magicType:{type:["line","bar"]},restore:{},saveAsImage:{}}},tooltip:{trigger:"item",axisPointer:{type:"cross"}},grid:{left:"10%",right:"10%",bottom:"10%",containLabel:!0},legend:{show:!0},xAxis:{type:"category",data:a,axisLabel:{show:!0,rotate:45},boundaryGap:!1,axisTick:{alignWithLabel:!0}},yAxis:{name:"Pressure (PSI)",nameTextStyle:{verticalAlign:"middle"},axisTick:{show:!0,inside:!0},type:"value",axisLine:{show:!0}},series:l};se.value.clear(),se.value.setOption(c)}},Je=(n=!1)=>{if(se.value){let e=[];Object.keys(m.value).forEach(s=>{const a=m.value[s].data;let l=[];for(let u=0;u<a.length;u++)l.push(parseFloat(a[u].avgPsiValues).toFixed(2));e.push(l)}),Ze(e,n)}};kt(()=>{Be()});const Oe=(n,e)=>{const a=m.value[n].data;for(let l=0;l<a.length;l++)if(a[l].idSpot==e)return a[l].avgPsiValues.toFixed(2)},K=n=>n.spot,Xe=(n,e)=>{const s=m.value[e],a=s.timerange,l=s.type,u=s.date;l==="normal"&&A.value===a+"."+l+"."+u&&(A.value=null),n.checked=!1;const c={...m.value};delete c[e],m.value=c},H=p(0),et=()=>{H.value++,E.value.push(null)},tt=()=>{H.value>0&&(H.value--,E.value.pop()),ne()},lt=(n,e)=>{E.value[e]=n,ne()};p(0);const G=p(!1),ie=p([]),j=p([]),U=p(!1),ue=p(),De=p(),at=async()=>{ie.value=[];const n=le.predict(m.value,D.value[C.value]);j.value=n,G.value=!0;for(let e=0;e<j.value.length;e++)j.value[e].suspectLocation.leak&&ie.value.push(j.value[e])},ot=(n,e)=>{ue.value=n,U.value=!1,U.value=!0,De.value=e};O(()=>G.value,()=>{G.value||(U.value=!1,j.value=null,ue.value=null,De.value=null)}),O(()=>be.value,()=>{nt(),W(_.value)});const nt=()=>{ge.value=Lt(be.value);const n={grid:{top:"10%",left:"10%",right:"10%",bottom:"15%"},legend:{show:!0,type:"scroll",orient:"horizontal"},xAxis:{type:"category",data:[],boundaryGap:!1,axisLabel:{rotate:45,labelStyle:{fontSize:10}},splitLine:{show:!0,lineStyle:{type:"dashed"}},axisTick:{alignWithLabel:!0}},yAxis:{type:"value",name:"Pressure (PSI)",nameGap:10,max:400,axisTick:{show:!0,inside:!0}},series:[]};ge.value.setOption(n)};let Ce=[];const re={},$e=p([]),R=p({}),st=p(),W=n=>{Ce=[];for(let a of D.value[C.value].spot)re[a.name]=[];P.value.slice(0,n+1).forEach((a,l)=>{const u=`${a.dateFilter} (${a.timeRange})`;Ce.push(u),st.value=u,a.data.forEach(c=>{const h=D.value[C.value].spot.find(q=>q.id===c.idSpot).name,M=c.avgPsiValues??0;re[h][l]=Number(M.toFixed(2))})});const s=Object.keys(re).map(a=>({name:a,type:"line",data:re[a],symbol:"none",smooth:!0,tooltip:{trigger:"axis",formatter:function(l){return l[0].value}},endLabel:{show:!0,formatter:function(l){return l.value},color:"#000",backgroundColor:"inherit",padding:5,borderRadius:5}}));ge.value.setOption({xAxis:{data:Ce},series:s})},Ie=p(!1),w=p(!1),it=n=>{w.value=!1,$e.value=[],_.value=parseInt(n.target.value,10),W(_.value),B.value=_.value/P.value.length*100};let F=null;O(()=>[w.value,ae.value],()=>{w.value?(F!=null&&clearInterval(F),F=setInterval(()=>{_.value<P.value.length?(_.value++,P.value[_.value]!=null&&(W(_.value),B.value=_.value/P.value.length*100)):(w.value=!1,clearInterval(F))},ae.value)):F&&(clearInterval(F),F=null)});const ut=()=>{Ie.value=!1,w.value=!1,_.value=0,$e.value=[],clearInterval(F),W(_.value),B.value=_.value/P.value.length*100},de=()=>{w.value=!1,_.value=0,$e.value=[],clearInterval(F),W(_.value),B.value=_.value/P.value.length*100},Le=p(!1);O(()=>R.value,()=>{w.value=!1,Le.value=!0},{deep:!0});const rt=()=>{Le.value=!1,w.value=!0},ce=p(0),dt=()=>D.value[C.value].trunkLength,S=p("trunk1"),pe=p(!1),I=p({}),$=p(null),Q=p(!0);let Z=null,J=null,X=null,ve=null;O(()=>S.value,()=>{Z=null,J=null,X=null,ve=null,$.value=null,I.value=null,I.value={},S.value=="trunk1"?Q.value=!0:S.value=="trunk2"?Q.value=!1:(S.value=="trunk3"||S.value=="trunk4")&&(Q.value=!0)});const ct=n=>{const e=n.id,s=n.value;I.value[e]=s,Object.keys(I.value).forEach(a=>{a=="0"?Z=I.value[a]:a=="1"?J=I.value[a]:a=="2"?X=I.value[a]:a=="3"&&(ve=I.value[a])}),S.value=="trunk1"?pt(Z,J,X,ve):S.value=="trunk2"?console.log("!"):S.value=="trunk3"?vt(Z,J,X):S.value=="trunk4"&&yt(Z,J,X,ve)},pt=(n,e,s,a)=>{const l=le.predictLocation(n,e,s,a);$.value=l},vt=(n,e,s)=>{const a=le.predictSglLocation(n,e,s);$.value=a},yt=(n,e,s,a)=>{const l=le.predictBtgLocation(n,e,s,a);$.value=l},Te=p(""),Se=p(""),Pe=p(!0),ye=p(!1);O(()=>V.value,()=>{const n=St(V.value),e=n.add(1,"days").format("YYYY-MM-DD"),s=n.subtract(2,"days").format("YYYY-MM-DD");Te.value=e,Se.value=s});const ft=()=>{V.value=Te.value,de(),ye.value&&(w.value=!0)},mt=()=>{V.value=Se.value,de(),ye.value&&(w.value=!0)};O(()=>w.value,()=>{!w.value&&_.value==P.value.length&&Pe.value&&(de(),w.value=!0)});const bt=n=>{ce.value=n};return(n,e)=>{const s=Ee("font-awesome-icon"),a=Ee("center");return o(),i(b,null,[pe.value?(o(),i("div",Pt,[t("div",{class:k(["q-prd-body",[`${r(d).mTheme}`]])},[t("button",{type:"button",class:"q-prd-close",onClick:e[0]||(e[0]=l=>pe.value=!1)},[v(s,{icon:"times"})]),t("h3",null,[t("b",{style:f({color:`${r(d).accentColor}`})},[v(s,{icon:"calculator"}),e[13]||(e[13]=g(" Quick Leak Prediction"))],4)]),v(me,{"in-label":"Select Line","model-value":S.value,"onUpdate:modelValue":e[1]||(e[1]=l=>S.value=l)},{default:T(()=>[(o(!0),i(b,null,L(he.value,(l,u)=>(o(),i("option",{key:u,value:l},y(D.value[l].name),9,Vt))),128))]),_:1},8,["model-value"]),e[17]||(e[17]=t("p",null,[t("b",null,"Deltas:")],-1)),Q.value?(o(),i("div",Mt,[(o(!0),i(b,null,L(K(D.value[S.value]),(l,u)=>(o(),te(fe,{key:u,onOnValueChange:ct,"in-id":String(u),"in-label":l.name,"in-type":"number","model-value":l.value,"onUpdate:modelValue":c=>l.value=c},null,8,["in-id","in-label","model-value","onUpdate:modelValue"]))),128))])):(o(),i("p",At,"Quick Prediction is currently not available for this line")),$.value?(o(),i("div",Rt,[e[16]||(e[16]=t("h4",{style:{"text-align":"center"}},[t("b",null,"Prediction result")],-1)),t("div",Ft,[$.value.suspectLocation.leak?(o(),i(b,{key:0},[t("h2",null,[t("b",Ot,y($.value.suspectLocation.message),1)]),t("h4",null,[e[14]||(e[14]=g("Leak Point: ")),t("b",null,y($.value.suspectLocation.leakData.leak_point)+" KM",1)]),t("h4",null,[e[15]||(e[15]=g("PU: ")),t("b",null,"KM "+y($.value.suspectLocation.leakData.pu_location),1)]),$.value.suspectLocation.useMap?x("",!0):(o(),i("p",It,"Map view not available")),$.value.suspectLocation.useMap?(o(),te(Ve,{key:1,latitude:$.value.suspectLocation.leakData.coordinate.latitude,longitude:$.value.suspectLocation.leakData.coordinate.longitude,"translate-address":!1,popup:`Leak: <b>${$.value.suspectLocation.leakData.leak_point} KM</b> <br> PU: KM <b>${$.value.suspectLocation.leakData.pu_location}</b>`},null,8,["latitude","longitude","popup"])):x("",!0)],64)):(o(),i(b,{key:1},[g(y($.value)+" ",1),t("ul",null,[(o(!0),i(b,null,L($.value.suspectLocation.probabilities,(l,u)=>(o(),i("li",{key:u},y(l),1))),128))])],64))])])):x("",!0)],2)])):x("",!0),v(xt,{"context-title":"FOL | Splitted History Data"},{default:T(()=>[t("div",Nt,[t("div",Et,[v(N,{onClick:e[2]||(e[2]=l=>pe.value=!pe.value),"bt-disabled":!1},{default:T(()=>[v(s,{icon:"calculator"}),e[18]||(e[18]=g(" Quick Leak Predict"))]),_:1})])]),t("div",Kt,[v(me,{"in-label":"Select Line","model-value":C.value,"onUpdate:modelValue":e[3]||(e[3]=l=>C.value=l)},{default:T(()=>[(o(!0),i(b,null,L(he.value,(l,u)=>(o(),i("option",{key:u,value:l},y(D.value[l].name),9,jt))),128))]),_:1},8,["model-value"]),v(me,{"in-label":"Time Range","model-value":oe.value,"onUpdate:modelValue":e[4]||(e[4]=l=>oe.value=l)},{default:T(()=>e[19]||(e[19]=[t("option",{value:"1"},"1 Menit",-1),t("option",{value:"2"},"2 Menit",-1),t("option",{value:"3"},"3 Menit",-1),t("option",{value:"4"},"4 Menit",-1),t("option",{value:"5"},"5 Menit",-1),t("option",{value:"15"},"15 Menit",-1),t("option",{value:"30"},"30 Menit",-1),t("option",{value:"60"},"60 Menit",-1)])),_:1},8,["model-value"]),t("div",Ut,[v(fe,{"in-type":"date","in-label":"Date Filter","model-value":V.value,"onUpdate:modelValue":e[5]||(e[5]=l=>V.value=l),style:{width:"100%"}},null,8,["model-value"])]),t("div",qt,[v(N,{onClick:tt,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:T(()=>[v(s,{icon:"minus"})]),_:1}),t("span",{class:k([`${r(d).textTheme}`])},y(H.value),3),v(N,{onClick:et,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:T(()=>[v(s,{icon:"plus"})]),_:1})]),(o(!0),i(b,null,L(H.value,(l,u)=>(o(),i("div",{key:u,style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},[v(fe,{"in-type":"date","in-label":`Date Filter ${l}`,onOnValueChange:c=>lt(c,u),style:{width:"100%"}},null,8,["in-label","onOnValueChange"])]))),128))]),t("div",Bt,[t("div",zt,[t("div",Yt,[t("div",Ht,[t("div",Gt,[e[20]||(e[20]=t("div",{style:{"background-color":"green",width:"20px",height:"20px","border-radius":"100px"}},null,-1)),t("span",{class:k([`${r(d).textTheme}`]),style:{"margin-left":"0.2rem","font-size":"12px","font-weight":"bold"}},"Nilai Tertinggi",2)]),t("div",Wt,[e[21]||(e[21]=t("div",{style:{"background-color":"red",width:"20px",height:"20px","border-radius":"100px"}},null,-1)),t("span",{class:k([`${r(d).textTheme}`]),style:{"margin-left":"0.2rem","font-size":"12px","font-weight":"bold"}},"Nilai Terendah",2)])]),v(N,{onClick:We,"bt-disabled":!1,"bt-type":"button","bt-size":"small",style:{height:"42px",width:"42px","border-radius":"100px",display:"flex","flex-flow":"row nowrap","align-items":"center"}},{default:T(()=>[v(s,{icon:"refresh"})]),_:1})]),t("table",Qt,[t("thead",Zt,[t("tr",{style:{padding:"20px"},class:k([`${r(d).textTheme}`])},[t("th",{style:f({border:`1px solid ${r(d).accentColor}`})},[v(s,{icon:"check-double"})],4),t("th",{style:f({border:`1px solid ${r(d).accentColor}`})},"Interval",4),(o(!0),i(b,null,L(K(D.value[C.value]),(l,u)=>(o(),i("th",{style:f({border:`1px solid ${r(d).accentColor}`}),key:u},y(l.name),5))),128))],2)]),t("tbody",null,[(o(!0),i(b,null,L(z.value,(l,u)=>(o(),i("tr",{key:u},[t("td",{style:f({border:`1px solid ${r(d).accentColor}`,width:"150px"}),class:k([`${r(d).textTheme}`])},[t("div",Jt,[v(Ue,{cb_disabled:Ge({timeRange:l.timeRange,type:"normal"}),cb_data:{timeRange:l.timeRange,type:"normal",rangeData:l.data,dateFilter:l.dateFilter},onOnCheckBoxChange:Re,cb_label:"Normal"},null,8,["cb_disabled","cb_data"]),v(Ue,{cb_disabled:!1,cb_checked:!1,cb_data:{timeRange:l.timeRange,type:"drop",rangeData:l.data,dateFilter:l.dateFilter},onOnCheckBoxChange:Re,cb_label:"Drop"},null,8,["cb_data"])])],6),t("td",{style:f({border:`1px solid ${r(d).accentColor}`}),class:k([`${r(d).textTheme}`])},[t("span",Xt,y(l.dateFilter),1),e[22]||(e[22]=t("br",null,null,-1)),g(y(l.timeRange),1)],6),(o(!0),i(b,null,L(K(D.value[C.value]),(c,h)=>(o(),i("td",{style:f({border:`1px solid ${r(d).accentColor}`,position:"relative"}),key:h,class:k([`${He(l,c.id)}`,`${r(d).textTheme}`])},[l.data.find(M=>M.idSpot===c.id)?(o(),i(b,{key:0},[g(y(l.data.find(M=>M.idSpot===c.id).avgPsiValues.toFixed(2)),1)],64)):(o(),i("span",el,"N/A"))],6))),128))]))),128))])])])])]),_:1}),ke.value?(o(),i("div",{key:1,class:k(["chart-container",[`${r(d).mTheme}`]])},[t("button",{onClick:Qe,class:"chc-dismiss",style:f({color:`${r(d).accentColor}`})},[v(s,{icon:"close"})],4),t("div",tl,[t("div",ll,[v(a,null,{default:T(()=>[v(fe,{"in-label":"Drop Tolerance Value","in-type":"number","model-value":ce.value,"onUpdate:modelValue":e[6]||(e[6]=l=>ce.value=l),style:{width:"200px"}},null,8,["model-value"])]),_:1}),Object.keys(m.value).length?(o(),te(_t,{key:0,onOnToleranceChanged:bt,"chart-data":m.value,"selected-spot":C.value,"trunk-length":dt(),"tolerance-value":ce.value,"prediction-result":ie.value},null,8,["chart-data","selected-spot","trunk-length","tolerance-value","prediction-result"])):x("",!0)])]),t("img",{src:r(Dt),alt:"map",style:{width:"100%",height:"375px","border-radius":"10px","object-fit":"contain"}},null,8,al),t("div",ol,[v(a,null,{default:T(()=>[Object.keys(m.value).length>1?(o(),te(N,{key:0,"bt-type":"button","bt-disabled":!1,onClick:at},{default:T(()=>[v(s,{icon:"water"}),e[23]||(e[23]=g(" Estimate Leak Location "))]),_:1})):x("",!0)]),_:1})]),t("div",nl,[t("h5",{style:{"margin-top":"1rem"},class:k([`${r(d).textTheme}`])},[t("b",null,[v(s,{icon:"oil-well"}),e[24]||(e[24]=g(" Selected Pressures"))])],2),t("table",sl,[t("thead",null,[t("tr",{style:{padding:"5px"},class:k([`${r(d).textTheme}`])},[t("th",{style:f({border:`1px solid ${r(d).accentColor}`})},"ACTION",4),t("th",{style:f({border:`1px solid ${r(d).accentColor}`})},"PINNED SERIES",4),(o(!0),i(b,null,L(K(D.value[C.value]),(l,u)=>(o(),i("th",{style:f({border:`1px solid ${r(d).accentColor}`}),key:u},y(l.name),5))),128))],2)]),t("tbody",null,[(o(!0),i(b,null,L(r(xe),(l,u)=>(o(),i("tr",{key:u},[t("td",{style:f({border:`1px solid ${r(d).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},[t("button",{onClick:c=>Xe(m.value[l].checkbox,l),class:"remove-series",type:"button"},[v(s,{icon:"close"})],8,il)],4),t("td",{class:k([`${r(d).textTheme}`]),style:f({border:`1px solid ${r(d).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},[g(y(m.value[l].date),1),e[25]||(e[25]=t("br",null,null,-1)),g(" "+y(m.value[l].timerange),1),e[26]||(e[26]=t("br",null,null,-1)),g(" "+y(m.value[l].type),1)],6),(o(!0),i(b,null,L(K(D.value[C.value]),(c,h)=>(o(),i("td",{style:f({border:`1px solid ${r(d).accentColor}`}),class:k([`${r(d).textTheme}`]),key:h},[Oe(l,c.id)?(o(),i(b,{key:0},[g(y(Oe(l,c.id)),1)],64)):(o(),i(b,{key:1},[g("0.00")],64))],6))),128))]))),128))])]),t("h5",{style:{"margin-top":"1rem"},class:k([`${r(d).textTheme}`])},[t("b",null,[v(s,{icon:"turn-down"}),e[27]||(e[27]=g(" Delta"))])],2),t("table",ul,[t("thead",null,[t("tr",{style:{padding:"5px"},class:k([`${r(d).textTheme}`])},[t("th",{style:f({border:`1px solid ${r(d).accentColor}`})},"DROPS",4),t("th",{style:f({border:`1px solid ${r(d).accentColor}`})},"PINNED SERIES",4),(o(!0),i(b,null,L(K(D.value[C.value]),(l,u)=>(o(),i("th",{style:f({border:`1px solid ${r(d).accentColor}`}),key:u},y(l.name),5))),128))],2)]),t("tbody",null,[(o(!0),i(b,null,L(we.value,(l,u)=>(o(),i("tr",{key:u,class:k([`${r(d).textTheme}`])},[t("td",{style:f({border:`1px solid ${r(d).accentColor}`})},y(u+1),5),t("td",{style:f({border:`1px solid ${r(d).accentColor}`})},y(l.dropKey.split(".")[0]+"."+l.dropKey.split(".")[1]+"."+l.dropKey.split(".")[2]),5),(o(!0),i(b,null,L(l.deltas,(c,h)=>(o(),i("td",{key:h,style:f({border:`1px solid ${r(d).accentColor}`})},y(c.toFixed(2)),5))),128))],2))),128))])])])],2)):x("",!0),G.value?(o(),i("div",rl,[t("div",{class:k(["leak-body",[`${r(d).mTheme}`]])},[t("button",{type:"button",onClick:e[7]||(e[7]=l=>G.value=!1),class:"leak-dismiss"},[v(s,{icon:"times"})]),t("div",{class:"l-left",style:f({width:U.value?"40%":"100%"})},[t("h4",{style:{"font-weight":"bold"},class:k([`${r(d).textTheme}`])},"Leak Analysis",2),e[32]||(e[32]=t("hr",null,null,-1)),(o(!0),i(b,null,L(j.value,(l,u)=>(o(),i("div",{class:"analysis-set",key:u},[l!=!1?(o(),i(b,{key:0},[t("h6",{class:k([`${r(d).textTheme}`])},[t("b",null,"Analysis on Dataset "+y(u+1),1)],2),t("p",null,[t("span",{class:k([`${r(d).textTheme}`])},"Result:",2),l!=!1&&l.suspectLocation.leak?(o(),i(b,{key:0},[t("b",{style:f({color:`${r(d).accentColor}`})},"Terdapat Indikasi Kebocoran",4),t("div",dl,[t("table",{style:{width:"100%","margin-top":"1rem"},class:k(["table table-striped table-hover;",[`${r(d).mTheme}`]])},[t("tr",null,[t("th",{style:f([{border:"1px solid #ccc",padding:"10px"},{color:`${r(d).accentColor}`}])}," Estimated Leak Point",4),l.suspectLocation.leakData.pu_location?(o(),i("th",{key:0,style:f([{border:"1px solid #ccc",padding:"10px"},{color:`${r(d).accentColor}`}])}," PU ",4)):x("",!0),l.suspectLocation.leakData.coordinate?(o(),i("th",{key:1,style:f([{border:"1px solid #ccc",padding:"10px"},{color:`${r(d).accentColor}`}])}," Coordinate ",4)):x("",!0)]),t("tbody",null,[t("tr",null,[t("td",{style:f([{color:`${r(d).accentColor}`},{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}])},y(l.suspectLocation.leakData.leak_point)+" KM ",5),l.suspectLocation.leakData.pu_location?(o(),i("td",{key:0,style:f([{color:`${r(d).accentColor}`},{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}])}," KM "+y(l.suspectLocation.leakData.pu_location),5)):x("",!0),l.suspectLocation.leakData.coordinate?(o(),i("td",{key:1,style:f([{color:`${r(d).accentColor}`},{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}])},[g(" Lat: "+y(l.suspectLocation.leakData.coordinate.latitude),1),e[28]||(e[28]=t("br",null,null,-1)),g(" Lng: "+y(l.suspectLocation.leakData.coordinate.longitude),1)],4)):x("",!0)])])],2)]),l.suspectLocation.leakData.coordinate?x("",!0):(o(),i("p",cl,[v(s,{icon:"info-circle"}),e[29]||(e[29]=g(" Map view and PU Location data is currently not supported for this line "))])),v(N,{onClick:c=>ot(l.suspectLocation.leakData.coordinate,"Leak Point: <b>"+l.suspectLocation.leakData.leak_point+" KM</b><br>PU Location: <b>KM "+l.suspectLocation.leakData.pu_location+"</b>"),"bt-disabled":!l.suspectLocation.leakData.coordinate},{default:T(()=>[v(s,{icon:"map-marker"}),e[30]||(e[30]=g(" Pinpoint on Map"))]),_:2},1032,["onClick","bt-disabled"]),l.suspectLocation.leakData.coordinate?(o(),i("a",{key:1,class:"gmaps",target:"_blank",href:`https://www.google.com/maps?q=${l.suspectLocation.leakData.coordinate.latitude},${l.suspectLocation.leakData.coordinate.longitude}`,style:{"margin-left":"0.5rem"}},"Google Maps",8,pl)):x("",!0)],64)):(o(),i(b,{key:1},[t("b",vl,[t("span",{style:f({color:`${r(d).accentColor}`})}," Tidak ada indikasi",4)]),t("ol",yl,[(o(!0),i(b,null,L(l.suspectLocation.probabilities,(c,h)=>(o(),i("li",{class:k([`${r(d).textTheme}`]),key:h},[t("span",null,y(c),1)],2))),128))])],64))])],64)):(o(),i("h6",fl,[t("b",null,"Analysis on Dataset "+y(u+1),1),e[31]||(e[31]=t("b",{style:{color:"#555"}},"Tidak ada indikasi",-1)),t("ol",ml,[(o(!0),i(b,null,L(l.suspectLocation.probabilities,(c,h)=>(o(),i("li",{key:h},y(c),1))),128))])]))]))),128))],4),U.value?(o(),i("div",{key:0,class:"l-right",style:f({width:U.value?"60%":"100%"})},[t("h4",{style:{"font-weight":"bold"},class:k([`${r(d).textTheme}`])},"Map View",2),e[33]||(e[33]=t("hr",null,null,-1)),v(Ve,{latitude:ue.value.latitude,longitude:ue.value.longitude,popup:De.value},null,8,["latitude","longitude","popup"])],4)):x("",!0)],2)])):x("",!0),Ie.value?(o(),i("div",bl,[t("button",{type:"button",onClick:ut,class:"leak-dismiss"},[v(s,{icon:"close"})]),e[37]||(e[37]=t("h5",{style:{"text-align":"center"}},[t("b",null,"History Data Playback")],-1)),v(a,null,{default:T(()=>[v(me,{style:{width:"400px"},"in-label":"Speed","model-value":ae.value,"onUpdate:modelValue":e[8]||(e[8]=l=>ae.value=l)},{default:T(()=>e[34]||(e[34]=[t("option",{value:"1000"},"Slowest",-1),t("option",{value:"500"},"Slower",-1),t("option",{value:"300"},"Moderate",-1),t("option",{value:"250"},"Faster",-1),t("option",{value:"200"},"Fastest",-1)])),_:1},8,["model-value"])]),_:1}),t("div",gl,[t("label",hl,[Ke(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>Pe.value=l),type:"checkbox"},null,512),[[je,Pe.value]]),e[35]||(e[35]=g(" Auto-replay "))]),t("label",kl,[Ke(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>ye.value=l),type:"checkbox"},null,512),[[je,ye.value]]),e[36]||(e[36]=g(" Autoplay on navigating "))])]),t("div",xl,[v(N,{"bt-disabled":!1,onClick:mt},{default:T(()=>[v(s,{icon:"backward"}),g("    "+y(Se.value),1)]),_:1}),t("span",wl,[t("b",null,y(V.value),1)]),v(N,{"bt-disabled":!1,onClick:ft},{default:T(()=>[g(y(Te.value)+"    ",1),v(s,{icon:"forward"})]),_:1})]),t("div",{ref_key:"heatMap",ref:be,style:{width:"100%",height:"600px"}},null,512),t("div",_l,[t("div",Dl,[w.value?x("",!0):(o(),i("button",{key:0,onClick:e[11]||(e[11]=l=>w.value=!w.value),class:"controlbtn",type:"button"},[v(s,{icon:"play"})])),w.value?(o(),i("button",{key:1,onClick:e[12]||(e[12]=l=>w.value=!w.value),class:"controlbtn",type:"button"},[v(s,{icon:"pause"})])):x("",!0)]),t("div",Cl,[t("input",{onChange:it,type:"range",min:0,max:P.value.length,value:_.value,class:"slider"},null,40,$l),t("span",Ll,[t("span",{class:"slider-track",style:f({width:`${B.value}%`})},null,4)])]),t("div",null,[!w.value&&_.value==P.value.length?(o(),i("button",{key:0,onClick:de,class:"controlbtn",type:"button"},[v(s,{icon:"undo"})])):x("",!0)])])])):x("",!0),Le.value?(o(),i("div",Tl,[t("div",Sl,[t("button",{type:"button",onClick:rt,class:"pbp-dismiss"},[v(s,{icon:"close"})]),e[41]||(e[41]=t("h3",null,[t("b",null,"Possible Leak Detected")],-1)),t("p",null,[e[38]||(e[38]=g(" Our system has detected a possible leak in the pipeline. Here goes the prediction details:")),e[39]||(e[39]=t("br",null,null,-1)),e[40]||(e[40]=t("br",null,null,-1)),t("h3",Pl,[t("b",null,"Position: "+y(R.value.suspectLocation.leakData.leak_point)+" KM ···· PU Location: "+y(R.value.suspectLocation.leakData.pu_location?`KM
          ${R.value.suspectLocation.leakData.pu_location}`:"Not Available"),1)]),R.value.suspectLocation.leakData.coordinate?(o(),te(Ve,{key:0,"leak-point":R.value.suspectLocation.leakData.leak_point,latitude:R.value.mapsLink.latitude,longitude:R.value.mapsLink.longitude,"pu-location":R.value.suspectLocation.leakData.pu_location},null,8,["leak-point","latitude","longitude","pu-location"])):x("",!0)])])])):x("",!0)],64)}}});export{Bl as default};
